nclude "stdafx.h"

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
typedef struct nodetype{
	char symbol;
		// 문자값    
			int frequency; // 파일에 있는 문자의 빈도수    
				struct nodetype* left;    //왼쪽 노드
					struct nodetype* right;   //오른쪽 노드
					}node;
					typedef struct pq   // 우선순위 대기열
					{    node* Node;         // 대기열에 있는 node    
					     struct pq* next;   // 다음 node
					     }pq;
					     #define ROOT    -1 // 부호화 함수 출력시 초기값
					     pq* insert(node* r);        // 우선순위 대기열에 노드를 정렬하여 삽입
					     node* Remove();             // 우선 순위 대기열에서 노드를 삭제
					     node* huffman(int n);       // 허프만 코드 트리를 만드는 함수
					     void print_PQ();            // 우선 순위 대기열 출력
					     void print_tree(node* r, int n, char* code);    // 결과 허프만 부호화 출력
					     void freetree(node* r);     // 메모리 해제
					     void writehuff();           //압축실행파일
					     void searchNode(node *r);
					     pq* PQ = NULL;      // 우선순위 대기열
					     FILE* file;         // 파일 식별자
					     int totallen=0;     //파일출력시 여분비트를 처분(001로 끝나지만 00100000이 된걸 처리해주기 위함)
					     char str[20];
					     void huffmanopen();  //문자열을 a2b3d4형식의코드(호프만)으로 바꾸어줌
					     int search(char c);   //배열에 같은글자가 이미 있는지 확인하고 없으면 넣고 있으면 카운트함
					     char huff[100]={0};  
					     int huff1[100]={0};
					     char huff2[100]={0};  
					     char huff3[100][20]={0}; //2진코드값저장
					     char filename[40];
					     int n1=0,n2=0;
					     int main(){    
					     	//
							int d;
								int n = 1;

									 
									 	
											while(1){
													n=1;
															totallen=0;
																	printf("\n호프만 코드 프로그램입니다.\n 1.호프만 압축 2.호프만 압축해제 3.종료");
																			node* result;
																					char* code;
																							scanf("%d",&d);
																									result= (node*) malloc(sizeof(node));   // 결과를 돌려받을 노드    
																											code = (char*) malloc(sizeof(char));    
																														switch(d){
																																		case 1 :
																																							
																																												huffmanopen();
																																																	file = fopen("huffman.txt", "r");  // 입력이 되는 문자와 빈도수   
																																																						if(file == NULL) {        
																																																												perror("File open error");        
																																																																		return 0;    
																																																																							}
																																																																												while(1) { 
																																																																																		node* r = (node*) malloc(sizeof(node));  
																																																																																								if( ( fscanf(file, "%c%d ",
																																																																																								                                                               &r->symbol, &r->frequency)) == -1)
																																																																																															       						{            
																																																																																																												break; //파일에 더 이상 값이 없으면 while 끝내기
																																																																																																																		}
																																																																																																																								else if(r->frequency==0)
																																																																																																																															break;
																																																																																																																																					r->left = NULL;      
																																																																																																																																											r->right = NULL;    
																																																																																																																																																	insert(r);      // 노드를 삽입 하면서 정렬함       
																																																																																																																																																							n++; 
																																																																																																																																																												}   
																																																																																																																																																																	
																																																																																																																																																																						fclose(file);
																																																																																																																																																																											printf("### Huffman Algorithm ###\n\n");   
																																																																																																																																																																																print_PQ();     // 입력이 끝난 우선순위 대기열   
																																																																																																																																																																																					result = huffman(n);    // 허프만 알고리즘    
																																																																																																																																																																																										printf("\n-- Result Huffman code tree\n");    
																																																																																																																																																																																															print_tree(result, ROOT, code);  
																																																																																																																																																																																																				writehuff();
																																																																																																																																																																																																									break;
																																																																																																																																																																																																													case 2 :
																																																																																																																																																																																																																		file = fopen("huffman.txt", "r");  // 입력이 되는 문자와 빈도수   
																																																																																																																																																																																																																								if(file == NULL) {        
																																																																																																																																																																																																																															perror("File open error");        
																																																																																																																																																																																																																																						return 0;    
																																																																																																																																																																																																																																												} 
																																																																																																																																																																																																																																																	while(1) { 
																																																																																																																																																																																																																																																							node* r = (node*) malloc(sizeof(node));  
																																																																																																																																																																																																																																																													if( ( fscanf(file, "%c%d ",
																																																																																																																																																																																																																																																													                                                                 &r->symbol, &r->frequency)) == -1)
																																																																																																																																																																																																																																																																					 						{            
																																																																																																																																																																																																																																																																																		break;//파일에 더 이상 값이 없으면 while 끝내기       
																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																														else if(r->frequency==0)
																																																																																																																																																																																																																																																																																																					break;
																																																																																																																																																																																																																																																																																																											r->left = NULL;      
																																																																																																																																																																																																																																																																																																																	r->right = NULL;    
																																																																																																																																																																																																																																																																																																																							insert(r);      // 노드를 삽입 하면서 정렬함       
																																																																																																																																																																																																																																																																																																																													n++; 
																																																																																																																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																																																																																																																							fclose(file);
																																																																																																																																																																																																																																																																																																																																												printf("### Huffman Algorithm ###\n\n");   
																																																																																																																																																																																																																																																																																																																																																	print_PQ();     // 입력이 끝난 우선순위 대기열   
																																																																																																																																																																																																																																																																																																																																																						result = huffman(n);    // 허프만 알고리즘    
																																																																																																																																																																																																																																																																																																																																																											printf("\n-- Result Huffman code tree\n");    
																																																																																																																																																																																																																																																																																																																																																																print_tree(result, ROOT, code);  
																																																																																																																																																																																																																																																																																																																																																																					searchNode(result);
																																																																																																																																																																																																																																																																																																																																																																										break;
																																																																																																																																																																																																																																																																																																																																																																														case 3:
																																																																																																																																																																																																																																																																																																																																																																																			return 0;
																																																																																																																																																																																																																																																																																																																																																																																							default :
																																																																																																																																																																																																																																																																																																																																																																																												printf("잘못 입력하셨습니다 다시입력해 주세요\n");
																																																																																																																																																																																																																																																																																																																																																																																															}
																																																																																																																																																																																																																																																																																																																																																																																																}
																																																																																																																																																																																																																																																																																																																																																																																																	
																																																																																																																																																																																																																																																																																																																																																																																																		   
																																																																																																																																																																																																																																																																																																																																																																																																		   	
																																																																																																																																																																																																																																																																																																																																																																																																				
																																																																																																																																																																																																																																																																																																																																																																																																					
																																																																																																																																																																																																																																																																																																																																																																																																						
																																																																																																																																																																																																																																																																																																																																																																																																							printf("\n");   // freetree(result);   
																																																																																																																																																																																																																																																																																																																																																																																																								// 메모리 해제   
																																																																																																																																																																																																																																																																																																																																																																																																									return 0;
																																																																																																																																																																																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																																																																																																																																																																																									void freetree(node* r)  // 메모리 해제
																																																																																																																																																																																																																																																																																																																																																																																																									{   
																																																																																																																																																																																																																																																																																																																																																																																																										if(r) { 
																																																																																																																																																																																																																																																																																																																																																																																																												freetree(r->left);  
																																																																																																																																																																																																																																																																																																																																																																																																														freetree(r->right);     
																																																																																																																																																																																																																																																																																																																																																																																																																free(r); 
																																																																																																																																																																																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																																																																																																																																																																																	pq* insert(node* r) // 우선순위 대기열에 노드 삽입
																																																																																																																																																																																																																																																																																																																																																																																																																	{    
																																																																																																																																																																																																																																																																																																																																																																																																																		pq* tmp = NULL;   
																																																																																																																																																																																																																																																																																																																																																																																																																			pq* new1 = NULL;    // 우선순위 대기열 추가할 새로운 공간 할당  
																																																																																																																																																																																																																																																																																																																																																																																																																				new1 = (pq*) malloc(sizeof(pq));  
																																																																																																																																																																																																																																																																																																																																																																																																																					new1->Node = r;      // 대기열에 추가할 새로운 공간에 r 노드값 삽입   
																																																																																																																																																																																																																																																																																																																																																																																																																						new1->next = NULL;  
																																																																																																																																																																																																																																																																																																																																																																																																																							if(PQ == NULL){    // 대기열이 비여있으면 새로운 공간이 리스트의 head가 됌    
																																																																																																																																																																																																																																																																																																																																																																																																																									PQ = new1;    
																																																																																																																																																																																																																																																																																																																																																																																																																											return PQ;  
																																																																																																																																																																																																																																																																																																																																																																																																																												} else if(PQ->Node->frequency > new1->Node->frequency) {     
																																																																																																																																																																																																																																																																																																																																																																																																																														new1->next = PQ;             // 루트 노드에 대한 비교 및 정렬        
																																																																																																																																																																																																																																																																																																																																																																																																																																PQ = new1;  
																																																																																																																																																																																																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																																																																																																																																																																																																		else {                            // 대기열에 리스트가 들어 있다면..     
																																																																																																																																																																																																																																																																																																																																																																																																																																				tmp = PQ;                       // tmp는 head       
																																																																																																																																																																																																																																																																																																																																																																																																																																						while(tmp->next != NULL) {        // 다음 노드가 없을때까지..           
																																																																																																																																																																																																																																																																																																																																																																																																																																									if(tmp->next->Node->frequency <= new1->Node->frequency)              
																																																																																																																																																																																																																																																																																																																																																																																																																																													tmp = tmp->next;        // 우선순위 대기열 정렬을 위한 비교           
																																																																																																																																																																																																																																																																																																																																																																																																																																																else {                       // new의 빈도수가 tmp 보다 크고,                
																																																																																																																																																																																																																																																																																																																																																																																																																																																				new1->next = tmp->next;  // tmp->next의 빈도수보다 작으면..                
																																																																																																																																																																																																																																																																																																																																																																																																																																																								tmp->next = new1;        // 두 노드 사이에 새 노드를 삽입         
																																																																																																																																																																																																																																																																																																																																																																																																																																																												break;       
																																																																																																																																																																																																																																																																																																																																																																																																																																																															}    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																	}       
																																																																																																																																																																																																																																																																																																																																																																																																																																																																			if(tmp->next == NULL)     // 다음 대기열이 비어 있으면 삽입           
																																																																																																																																																																																																																																																																																																																																																																																																																																																																						tmp->next = new1;     
																																																																																																																																																																																																																																																																																																																																																																																																																																																																								return tmp;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																									}   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																										return 0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																										node* huffman(int n)    // 허프만 알고리즘
																																																																																																																																																																																																																																																																																																																																																																																																																																																																										{    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																											node* p;  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																												node* q;  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																													node* r;  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																														int i;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																															for(i = 1; i < n-1; i++) {  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	p = Remove();   // 우선 순위 대기열에서 하나의 노드를 빼와서 p에 삽입     
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			q = Remove();   // 우선 순위 대기열에서 하나의 노드를 빼와서 q에 삽입     
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					r = (node*) malloc(sizeof(node)); // 새로운 부분 트리를 위한 공간 할당      
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							r->left = p;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									r->right = q;     
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											r->frequency = p->frequency + q->frequency;    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													r->symbol = '*';  // 부분 트리의 뿌리임을 나타냄       
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															insert(r);          // 만들어진 부분 트리를 우선 순위 대기열에 삽입    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	printf("-- Create sub tree (%d/%d)\n  ", i, n-2);  

																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			printf("%c:%d = %c:%d + %c:%d\n",r->symbol, r->frequency
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						, p->symbol, p->frequency, q->symbol, q->frequency);    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								print_PQ();  

																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									}   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										r = Remove();   // 우선 순위 대기열에 있는 트리의 뿌리를 빼와서 r에 대입   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											return r;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											node* Remove()  // 우선 순위 대기열에서 하나의 노드를 빼서 리턴값으로 넘긴다
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											{    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												node* pq_firstnode = NULL;  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													pq_firstnode = PQ->Node; 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														PQ = PQ->next;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															return pq_firstnode;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															void print_PQ()     // 우선순위 대기열 출력
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															{   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																pq* tmp = PQ;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	printf("-- Priority Queue\n  | ");  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		while(tmp != NULL){      
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				printf("%c:%d | ", tmp->Node->symbol, tmp->Node->frequency);    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						tmp = tmp->next;   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							}   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								printf("\n\n");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								void print_tree(node* r, int n, char* code) // 결과 허프만 알고리즘  트리 출력
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								{   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										if(r) {    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												n++;    // 트리의 깊이를 표시        
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														code[n] = '0';    // 트리의 좌측       
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																print_tree(r->left, n, code);        
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		code[n] = '1';    // 트리의 우측      
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				print_tree(r->right, n, code);      
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						code[n] = '\0';   // 찌꺼기 제거    
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								if(r->left == NULL || r->right == NULL){   // 자식이 있는 노드는 출력하지 않음   
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											printf(" - %c:%d\t= %s\n", r->symbol, r->frequency, code);  
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														huff2[n2]=r->symbol;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	totallen+=r->frequency;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				strncpy(huff3[n2],code,strlen(code));
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							n2++;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										void huffmanopen(){ //일반단어들을 a1b2d3같은 규칙으로 저장함(호프만코드)
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											FILE *file;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												char c;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													while(1){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															gets(filename);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	printf("압축할 파일명을 입력해 주세요 ");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			gets(filename);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					file=fopen(filename,"r");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							if(file!=NULL)
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										break;		
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													while(1){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															if(fscanf(file,"%c",&c)==-1)
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		break;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				search(c);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						fclose(file);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								file=fopen("huffman.txt","w+");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									if(file==NULL){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											printf("file open error retry insert\n");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													for(int i=0;i<n1;i++){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															memset(str,0,sizeof(str));
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	sprintf(str,"%c%d",huff[i],huff1[i]);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			fwrite(str,strlen(str),1,file);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					memset(str,0,sizeof(str));
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						sprintf(str,"%c%d",'*',0);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							fwrite(str,strlen(str),1,file);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								fclose(file);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								void writehuff(){//위 글자들을 압축(비트단위로 저장함)
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									FILE *file2;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										FILE *file1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											int unsig=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												char c;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													unsigned c1=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														file1=fopen(filename,"r");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															if(file1==NULL){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	printf("fileopenerror1");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			file2=fopen("huffman.txt","a+");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				printf("생성된비트:");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					fputc(0,file2);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							while(fscanf(file1, "%c",&c)==1){//한글자 읽어서
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										for(int i=0;i<n2;i++){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														if(huff2[i]==c){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			for(int j=0;j<strlen(huff3[i]);j++){//1바이트를 8비트로연산
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									switch(huff3[i][j]){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																case '0':
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								c1 = c1<<1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																printf("0");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								break;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															case '1':
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							c1 = c1<<1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															c1=c1|1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							printf("1");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															break;

																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											unsig++;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							if(unsig==8){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														unsig=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					fputc(c1,file2);//8비트가 다 차면 저장
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												c1=0;						
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		}	
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														}			
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		if(unsig!=0){//남은비트저장
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					c1=c1<<(8-unsig);		
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								fputc(c1,file2);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												fclose(file1);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													fclose(file2);	
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													int search(char c){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														for(int i=0;i<n1;i++){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																if(huff[i]==c){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			huff1[i]++;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						return 1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										huff[n1]=c;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											huff1[n1]=1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												n1++;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													return 0;	
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													void searchNode(node *r){ //2진코드를 해석해서 숫자로 압축 풀음
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														node *r2=r;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															char str3[20];
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																FILE *file2;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	FILE *file1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		int gabi;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			int unsig=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				char c=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					int t=0;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						file1=fopen("result.txt","w+");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							file2=fopen("huffman.txt","r");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								while(1){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										if( ( fscanf(file2, "%c%d",&c,&gabi)) == -1)
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												{            
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															break;       // 파일에 더 이상 값이 없으면 while 끝내기       
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			if(c=='*'){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						break;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										fscanf(file2, "%c",&c);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											printf("생성된비트:");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												while(fscanf(file2, "%c",&c)!=-1){  //한글자 읽어서
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														int a;	
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																for(int i=0;i<8;i++){      //8비트연산
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			a=((c&128)==128);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						c=c<<1;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									if(t==totallen){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													fclose(file1);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	fclose(file2);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					return;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											if((r2->right==NULL)&&(r2->left==NULL)){ //뿌리노드면 출력
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															fputc(r2->symbol,file1);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			r2=r;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							t++;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													if(a){
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	r2=r2->right;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					printf("1");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											else{
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															r2=r2->left;
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			printf("0");
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												}
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																													fclose(file1);
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														fclose(file2);

																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																}
